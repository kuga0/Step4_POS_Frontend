(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[536],{1276:function(e,t,n){Promise.resolve().then(n.bind(n,4699))},4699:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var s=n(7437),c=n(2265),a=n(3464),l=n(6022),r=n.n(l),i=e=>{let{products:t,addToPurchaseList:n}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"section-title",children:"商品マスタ一覧"}),(0,s.jsx)("ul",{className:"product-list",children:t.map((e,t)=>(0,s.jsxs)("li",{className:"product-item",children:[e.name," - ",e.price,"円",(0,s.jsx)("button",{onClick:()=>n(e),className:"add-button",children:"追加"})]},t))})]})},o=e=>{let{purchaseList:t,selectItem:n,removeSelectedItem:c,selectedItem:a}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"section-title",children:"購入リスト"}),(0,s.jsx)("ul",{className:"purchase-list",children:t.map((e,t)=>(0,s.jsxs)("li",{onClick:()=>n(e),className:"purchase-item ".concat(a&&a.code===e.code?"selected":""),children:[e.name," - ",e.price,"円 \xd7 ",e.quantity,(0,s.jsx)("button",{onClick:c,className:"remove-button",children:"削除"})]},t))})]})},u=e=>{let{isScanning:t,startScanner:n,stopScanner:c}=e;return(0,s.jsxs)("div",{className:"scanner-controls",children:[(0,s.jsx)("button",{onClick:n,className:"control-button",children:"スキャン開始"}),t&&(0,s.jsx)("button",{onClick:c,className:"control-button",children:"スキャナーを停止"})]})},d=e=>{let{scannedCode:t,setScannedCode:n,handleCodeInput:c}=e;return(0,s.jsxs)("div",{className:"code-input",children:[(0,s.jsx)("input",{type:"text",value:t,onChange:e=>n(e.target.value),placeholder:"コード入力",className:"input-field"}),(0,s.jsx)("button",{onClick:c,className:"control-button",children:"コードで商品追加"})]})},h=e=>{let{handlePurchase:t}=e;return(0,s.jsx)("button",{onClick:t,className:"purchase-button",children:"購入"})};function m(){let[e,t]=(0,c.useState)([]),[n,l]=(0,c.useState)([]),[m,p]=(0,c.useState)(""),[x,j]=(0,c.useState)(null),[f,N]=(0,c.useState)(0),[v,b]=(0,c.useState)(!1),C=(0,c.useRef)(null);(0,c.useEffect)(()=>{(async()=>{try{let e=await a.Z.get("".concat("http://127.0.0.1:8000","/products"));t(e.data)}catch(e){console.error("商品一覧取得エラー:",e)}})()},[]),(0,c.useEffect)(()=>{N(n.reduce((e,t)=>e+t.price*t.quantity,0))},[n]);let S=e=>{n.find(t=>t.code===e.code)?l(n.map(t=>t.code===e.code?{...t,quantity:Math.min(t.quantity+1,99)}:t)):l([...n,{...e,quantity:1}])};return(0,s.jsxs)("div",{className:"app-container",children:[(0,s.jsx)(u,{isScanning:v,startScanner:()=>{r().init({inputStream:{name:"Live",type:"LiveStream",target:C.current,constraints:{facingMode:"environment"}},decoder:{readers:["ean_reader"]}},e=>{if(e){console.error(e);return}r().start(),b(!0)}),r().onDetected(t=>{var n;if(null==t?void 0:null===(n=t.codeResult)||void 0===n?void 0:n.code){let n=t.codeResult.code;p(n);let s=e.find(e=>e.code===n);s?(S(s),alert("リストに商品を追加しました！")):alert("商品が見つかりませんでした。")}else console.warn("コードの読み取りに失敗しました。")})},stopScanner:()=>{r().stop(),b(!1)}}),(0,s.jsx)("div",{ref:C,className:"video-container",style:{display:v?"block":"none"}}),(0,s.jsx)(d,{scannedCode:m,setScannedCode:p,handleCodeInput:()=>{}}),(0,s.jsx)(i,{products:e,addToPurchaseList:S}),(0,s.jsx)(o,{purchaseList:n,selectItem:()=>{},removeSelectedItem:()=>{},selectedItem:null}),(0,s.jsxs)("h3",{className:"section-title",children:["合計: ",f,"円（税込）"]}),(0,s.jsx)(h,{handlePurchase:()=>{}})]})}function p(){return(0,s.jsx)(m,{})}}},function(e){e.O(0,[588,464,971,117,744],function(){return e(e.s=1276)}),_N_E=e.O()}]);